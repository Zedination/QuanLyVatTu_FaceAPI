
(function(c){var a={options:function(e){var f=c(this);if(e){if(e.mode){f.data("mode",e.mode)}if(e.fade_dur&&!isNaN(e.fade_dur)){f.data("fade_dur",parseInt(e.fade_dur))}if(e.size&&e.size["w"]&&e.size["h"]&&!isNaN(e.size["w"])&&!isNaN(e.size["h"])){f.data("width",parseInt(e.size["w"]));f.data("height",parseInt(e.size["h"]))}if(e.header&&e.h_height&&!isNaN(e.h_height)){f.data("header",e.header);f.data("h_height",parseInt(e.h_height))}if(e.h_show){f.data("h_show",e.h_show);f.data("h_show_dur",!isNaN(e.h_show_dur)?parseInt(e.h_show_dur):0)}if(e.footer&&e.f_height&&!isNaN(e.f_height)){f.data("footer",e.footer);f.data("f_height",parseInt(e.f_height))}if(e.f_show){f.data("f_show",e.f_show);f.data("f_show_dur",!isNaN(e.f_show_dur)?parseInt(e.f_show_dur):0)}}var d=f.data("ImageViewer");if(d){if(f.data("fade_dur")>=0){d.SetFadeDuration(f.data("fade_dur"));f.removeData("fade_dur")}if(f.data("width")&&f.data("height")){d.SetSize(f.data("width"),f.data("height"));f.removeData("width");f.removeData("height")}if(f.data("header")&&f.data("h_height")){d.SetFloatingPanel(f.data("header"),f.data("h_height"),true);f.removeData("header");f.removeData("h_height")}if(f.data("h_show")){d.ShowFloatingPanel((f.data("h_show")=="show")?true:false,f.data("h_show_dur"),true);f.removeData("h_show");f.removeData("h_show_dur")}if(f.data("footer")&&f.data("f_height")){d.SetFloatingPanel(f.data("footer"),f.data("f_height"),false);f.removeData("footer");f.removeData("f_height")}if(f.data("f_show")){d.ShowFloatingPanel((f.data("f_show")=="show")?true:false,f.data("f_show_dur"),false);f.removeData("f_show");f.removeData("f_show_dur")}}},show:function(e,d,h){var g=c(this);var f=g.data("ImageViewer");if(!f){if(this.tagName.toLowerCase()!="div"){return}if(g.data("mode")=="popup"){f=new b(c("<div></div>").appendTo(c("body")),true)}else{f=new b(g,false)}g.removeData("mode");g.data("ImageViewer",f);a.options.apply(this,new Array())}f.ShowImage(e,d,h)},hide:function(){var e=c(this);var d=e.data("ImageViewer");if(d){if(d.m_bPopupMode){c(window).unbind("resize scroll");d.m_dvWrapPanel.remove()}e.empty();e.removeData("ImageViewer")}}};c.fn.imageviewer=function(e){var d=arguments;return this.each(function(){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(d,1))}else{if(typeof e==="object"||!e){return a.options.apply(this,d)}else{c.error("Method '"+e+"' does not exist in jQuery.imageviewer")}}})};function b(n,k){var h=this;if(!(h instanceof b)){return false}if(n.length==0){return false}var e={position:"relative",top:0,left:0,overflow:"hidden"};var m={position:"absolute",top:0,left:0,overflow:"hidden"};var f={position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0.4};var d={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"};var i={position:"absolute",top:0,left:0,width:"100%",height:"100%"};var g={position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0.6};var l={position:"absolute",top:0,left:0,width:"100%",height:"100%"};h.m_dvWrapPanel=n;h.m_nViewerW=100;h.m_nViewerH=100;h.m_bFixedSize=false;h.m_bPopupMode=k;h.m_nImageFadeDuration=0;h.m_FloatPanels=[];h.m_FloatPanelsStat=[];h.mTmpHref="";h.mTmpTarget="";h.mTmpImage=new Image();h.mTmpImage.onload=function(){h.ShowImage(h.mTmpImage,h.mTmpHref,h.mTmpTarget)};var j="";j+='<div  class="wrappanellayer ivImageBgColor" >';j+='<div class="mainpanellayerimg" id="test" ></div>';j+='<div class="mainpanellayerimg" ></div>';j+='<div  class="mainpanellayerload ivLoadingBgColor"></div>';j+='<div class="mainpanellayerload ivLoadingImage"></div>';j+="</div>";h.m_dvWrapPanel.empty().append(c(j));h.m_dvMainPanel=h.m_dvWrapPanel.find("div.wrappanellayer").css(d);h.m_dvImgBgLayer=h.m_dvMainPanel.find("div.mainpanellayerimg").eq(0).css(i);h.m_dvImgFgLayer=h.m_dvMainPanel.find("div.mainpanellayerimg").eq(1).css(i);h.m_dvLoadLayers=h.m_dvMainPanel.find("div.mainpanellayerload").eq(0).css(g).end().eq(1).css(l).end().hide();if(h.m_bPopupMode){bgDivObj=c('<div class="ivDisableColor"></div>').css(f);h.m_dvWrapPanel.prepend(bgDivObj);h.m_dvWrapPanel.css(m).width(c(document).width()).height(c(document).height());c(window).bind("resize scroll",function(o){h.m_dvWrapPanel.width(c(document).width()).height(c(document).height());b.routines.calcPositions(h,null)})}else{h.m_dvWrapPanel.css(e).width(h.m_nViewerW).height(h.m_nViewerH)}b.routines.calcPositions(h,null);c(window).bind("unload",function(){h.m_dvWrapPanel.empty()})}b.prototype={ShowImage:function(k,i,f){var d=this;if(!(d instanceof b)){return false}if(!k.width){d.m_dvLoadLayers.stop(true,true).fadeIn(0);if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var h=d.mTmpImage.src;d.mTmpImage.src=k;var j=d.mTmpImage.src;if(j==h){d.ShowImage(d.mTmpImage,i,f);return}}d.mTmpHref=i;d.mTmpTarget=f;d.mTmpImage.src=k;return}if(k!=d.mTmpImage){d.mTmpImage.src=""}d.m_dvLoadLayers.stop(true,true).fadeOut(d.m_nImageFadeDuration);b.routines.calcPositions(d,k);var e="";e+='<table width="100%" id="test1" height="100%" cellpadding="0" cellspacing="0">';e+="<tr>";e+='<td align="center" valign="middle">';if(i&&(i!="")){e+='<a href="'+i+'" target="'+f+'">';e+='<img oncontextmenu="return false;"  src="'+k.src+'" onclick="$(\'#ex_popup_viewer\').imageviewer(\'hide\');return false;" style="border-width:0" width="'+(d.m_nViewerW  * 0.8)+'" height="'+(d.m_nViewerH * 0.8)+'" />';e+="</a>"}else{e+='<img src="'+k.src+'"  oncontextmenu="return false;" onclick="$(\'#ex_popup_viewer\').imageviewer(\'hide\');return false;" style="border-width:0" width="'+(d.m_nViewerW * 0.8)+'" height="'+(d.m_nViewerH * 0.8)+'" />'}e+="</td>";e+="</tr>";e+="</table>";d.m_dvImgFgLayer.stop(true,true);d.m_dvImgBgLayer.stop(true,true);d.m_dvImgBgLayer.empty().append(c(e)).css({opacity:0}).show();var g=d.m_dvImgBgLayer;d.m_dvImgBgLayer=d.m_dvImgFgLayer;d.m_dvImgFgLayer=g;d.m_dvImgFgLayer.animate({opacity:1},d.m_nImageFadeDuration,function(){d.m_dvImgBgLayer.empty().hide()});d.m_dvImgBgLayer.animate({opacity:0},d.m_nImageFadeDuration)},SetFloatingPanel:function(h,l,f){var k={position:"absolute",top:0,left:0,width:"100%",height:0,overflow:"hidden"};var i={position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0.7};var e={position:"absolute",top:0,left:0,width:"100%",height:"100%"};var g=this;if(!(g instanceof b)){return false}var j="";j+="<div>";j+='<div class="floatingpanellayer ivFloatBgColor"></div>';j+='<div class="floatingpanellayer">'+h+"</div>";j+="</div>";var d=c(j).css(k).height(l);d.find("div.floatingpanellayer").eq(0).css(i).end().eq(1).css(e).end();if(g.m_FloatPanels[f]){g.m_FloatPanels[f].remove();g.m_FloatPanels[f]=null}g.m_FloatPanels[f]=d;g.m_dvMainPanel.append(g.m_FloatPanels[f]);g.ShowFloatingPanel(false,0,f)},ShowFloatingPanel:function(f,h,e){var d=this;if(!(d instanceof b)){return false}if(d.m_FloatPanels[e]){var g=0;if(e){g=f?0:(-1)*d.m_FloatPanels[e].height()}else{g=f?(d.m_dvMainPanel.height()-d.m_FloatPanels[e].height()):d.m_dvMainPanel.height()}d.m_FloatPanels[e].stop(true,false).animate({top:g},h);d.m_FloatPanelsStat[e]=f}},SetSize:function(e,f){var d=this;if(!(d instanceof b)){return false}if(!isNaN(e)&&!isNaN(f)){d.m_nViewerW=Math.max(100,parseInt(e));d.m_nViewerH=Math.max(100,parseInt(f));d.m_bFixedSize=true;b.routines.calcPositions(d,null)}},SetFadeDuration:function(e){var d=this;if(!(d instanceof b)){return false}if(!isNaN(e)&&(parseInt(e)>=0)){d.m_nImageFadeDuration=parseInt(e)}}};b.routines={calcPositions:function(d,h){var f=false;if(!d.m_bFixedSize&&h&&h.width&&h.height){d.m_nViewerW=h.width;d.m_nViewerH=h.height}if(d.m_bPopupMode){var g=Math.round((c(window).height()-d.m_nViewerH)/2)+c(window).scrollTop()+"px";var e=Math.round((c(window).width()-d.m_nViewerW)/2)+c(window).scrollLeft()+"px";if((d.m_dvMainPanel.width()!=d.m_nViewerW)||(d.m_dvMainPanel.height()!=d.m_nViewerH)||(d.m_dvMainPanel.css("top")!=g)||(d.m_dvMainPanel.css("left")!=e)){d.m_dvMainPanel.width(d.m_nViewerW).height(d.m_nViewerH);d.m_dvMainPanel.css({top:g,left:e});f=true}}else{if(d.m_dvWrapPanel.width()!=d.m_nViewerW||d.m_dvWrapPanel.height()!=d.m_nViewerH){d.m_dvWrapPanel.width(d.m_nViewerW).height(d.m_nViewerH);f=true}}if(f){if(d.m_FloatPanels[true]){d.ShowFloatingPanel(d.m_FloatPanelsStat[true],0,true)}if(d.m_FloatPanels[false]){d.ShowFloatingPanel(d.m_FloatPanelsStat[false],0,false)}}}}})(jQuery);